# 02. react-redux

## 02-01. ë¦¬ë•ìŠ¤ í´ë” êµ¬ì¡°

ìš°ì„  ìƒˆ í´ë”ë¥¼ ë§Œë“¤ê³  01ì—ì„œ ì‘ì„±í•œ ì½”ë“œë¥¼ ê°€ì ¸ì™€ ì‚´í´ë³´ì.

ë³„ë¡œ í•œê²Œ ì—†ì§€ë§Œ 90ì¤„ì´ ë„˜ì–´ê°„ë‹¤.

ì˜ê²Œ ìª¼ê°œë³´ì.



**ìš°ì„  reducerë¥¼ reducer.jsë¡œ ë¶„ë¦¬**

ë¶„ë¦¬ê°€ ì‰¬ìš´ê²Œ **ìˆœìˆ˜í•¨ìˆ˜**ë¼ ê·¸ë ‡ë‹¤.

> ìˆœìˆ˜ í•¨ìˆ˜
>
> ë§¤ê°œë³€ìˆ˜ì™€ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ì„ ì–¸í•œ ë³€ìˆ˜ë¥¼ ë¹¼ê³ ëŠ” ë‹¤ë¥¸ ê²ƒì„ ì°¸ì¡°í•˜ì§€ ì•ŠëŠ” í•¨ìˆ˜

```js
// reducer.js
const reducer = (prevState, action) =>{
  switch(action.type){
    case 'LOG_IN':
      return{
        ...prevState,
        user: action.data,
      }
    case 'LOG_OUT':
      return{
        ...prevState,
        user: null,
      }
    case 'ADD_POST':
      return{
        ...prevState,
        posts: [...prevState.posts, action.data],
      }
    default: return prevState;
  }
};

module.exports = reducer;
```

```js
// index.js
const reducer = require('./reducer');
...
```



ê·¸ ë‹¤ìŒ ê¸¸ì–´ì§ˆ ë§Œí•œê²Œ **action creatorë“¤**

```js
// action.js
const login = (data) => {
  return {
    type:'LOG_IN',
    data,
  }
}
const logout = () => {
  return {
    type:'LOG_OUT',
  }
}
const addPost = (data) =>{
  return{
    type:'ADD_POST',
    data
  }
}

module.exports = {
  login,
  logout,
  addPost
};
```

```js
// index.js
const {login, logout, addPost, } = require('./action');
...
```

>  â— Tip
>
> actionê³¼ reducerë“¤ì´ ê¸¸ì–´ì§€ê²Œ ë˜ë©´, ë˜ ê·¸ì•ˆì—ì„œ ë‚˜ëˆ„ì–´ì•¼ ë˜ëŠ” ê²½ìš°ë„ ìˆì„ ìˆ˜ ìˆë‹¤.
>
> ê·¸ëŸ´ ë• actionsí´ë” reducersí´ë”ë¥¼ ë§Œë“¤ì–´ ì¹´í…Œê³ ë¦¬ë³„ë¡œ êµ¬ë¶„í•˜ì—¬ ë§Œë“¤ì–´ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ë„ ìˆë‹¤.



reducersí´ë”ì•ˆì— index.jsíŒŒì¼ì„ ë§Œë“¤ì–´ ì˜®ê²¨ë³´ì.<br>(ë³´í†µ ëŒ€í‘œê°€ ë˜ëŠ” íŒŒì¼ì„ index.jsë¡œ ë§Œë“ ë‹¤.)

ê·¸ë¦¬ê³  actionë„ ì¥ê¸°ì ì¸ ê´€ì ìœ¼ë¡œ ë´¤ì„ ë•Œ userê´€ë ¨ actiionì¸ login, logoutê³¼ ê²Œì‹œê¸€ ê´€ë ¨ì¸ addPostë¥¼ ë‚˜ëˆ„ëŠ”ê²Œ ì¢‹ì•„ ë³´ì¸ë‹¤. 

```js
// action/user.js
const login = (data) => {
  return {
    type:'LOG_IN',
    data,
  }
}
const logout = () => {
  return {
    type:'LOG_OUT',
  }
}

module.exports={
  login, logout
}
```

```js
// action/post.js
const addPost = (data) =>{
  return{
    type:'ADD_POST',
    data
  }
}

module.exports = {addPost}
```





â— stateì˜ êµ¬ì¡°ì— ë”°ë¼ íŒŒì¼ì„ ë¶„ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤. => **state êµ¬ì¡°ë¥¼ ì˜ì§œëŠ”ê²Œ ì¤‘ìš”**

**example**

```js
const initialState = {
    user: null,
    isLoggingIn: true,
    posts: [],
    comments: [],
    favorites: [],
    history: [],
    likes: [],
    followers: [],
}
```

ì´ì™€ ê°™ì€ ê²½ìš°ê°€ ìˆë‹¤ê³  í• ë•Œ commentsê°€ ê²Œì‹œê¸€ì— ë¬¶ì—¬ìˆìœ¼ë‹ˆ postsì•ˆì— ë„£ëŠ” ê²½ìš°ë„ ìˆì„ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ commentsì˜ ë©ì¹˜ê°€ ì»¤ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ë°–ìœ¼ë¡œ ë¹¼ëŠ”ê²Œ ì¢‹ë‹¤. 

=> ì—°ê´€ìˆëŠ”ê±´ ë¬¶ëŠ”ê²Œ ì¢‹ì§€ë§Œ, ë©ì¹˜ê°€ ì»¤ì§ˆë§Œí•œê±´ ë”°ë¡œ êµ¬ë¶„í•˜ëŠ”ê²Œ ì¢‹ë‹¤.



Q. ì´ëŸ° ê°ì²´ë“¤ì´ ëŠ˜ì–´ë‚˜ë©´ ì„±ëŠ¥ ë¬¸ì œëŠ” ì—†ëŠ”ê°€?

A. ë©”ëª¨ë¦¬ì— ë§ì´ ì°¨ì§€í•˜ê¸´ í•˜ì§€ë§Œ, ì—„ì²­ë‚˜ê²Œ ë§ì´ ì°¨ì§€í•˜ì§„ ì•ŠëŠ”ë‹¤.<br/> ë©”ëª¨ë¦¬ ê´€ë¦¬ê°€ í•„ìš”í•œ ìƒí™©(ex)infinite scroll)ì´ ìƒê¸¸ ìˆœ ìˆì§€ë§Œ, í° ë¬¸ì œëŠ” ìƒê¸°ì§€ ì•ŠëŠ”ë‹¤.

ì„œë¹„ìŠ¤ë§ˆë‹¤ ë‹¤ë¥´ê¸´í•˜ì§€ë§Œ, ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•ŒëŠ” í•œ í˜ì´ì§€ì— ë³´ì´ëŠ” ì •ë„ë§Œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì¢‹ë‹¤.

í˜ì´ìŠ¤ë¶ì²˜ëŸ¼ ë¹ ë¥´ê²Œ ë¹ ë¥´ê²Œ ê¸€ë“¤ì„ ë„˜ê²¨ë´ì•¼í•  ë•ŒëŠ” ë§ì´ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì¢‹ì§€ë§Œ, ë¸”ë¡œê·¸ê°™ì€ ê²½ìš°ëŠ” í•œí˜ì´ì§€ì— ë³´ì´ëŠ” ì •ë„ë§Œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ì¢‹ë‹¤.





## 02-02. combineReducer

actionì„ ìª¼ê° ê²ƒ ì²˜ëŸ¼ reducerë¥¼ ìª¼ê°œë³´ì.

reducerëŠ” í•¨ìˆœë° ì–´ë–»ê²Œ?

**ì´ë¶€ë¶„ì€ reduxì—ì„œ ì œê³µí•œë‹¤. => combineReducers**

ìš°ì„  2ê°œë¡œ ë‚˜ëˆ ë³´ì.

```js
const {combineReducers} = require('redux');

const userReducer = (prevState, action) =>{
  switch(action.type){
    case 'LOG_IN':
      return{
        ...prevState,
        user: action.data,
      }
    case 'LOG_OUT':
      return{
        ...prevState,
        user: null,
      }
    default: return prevState;
  }
};
const postReducer = (prevState, action) =>{
  switch(action.type){
    case 'ADD_POST':
      return{
        ...prevState,
        posts: [...prevState.posts, action.data],
      }
    default: return prevState;
  }
};
```

ì¼ë‹¨ ë‚˜ëˆ´ëŠ”ë° í•¨ìˆ˜ 2ê°œë¥¼ ì–´ë–»ê²Œ í•©ì¹ ê¹Œ?

combineReducersë¥¼ ì‚¬ìš©!

```js
combineReducers({
  user: userReducer,
  posts: postReducer
})
```

ì´ì œ íŒŒì¼ì„ ë¶„ë¦¬í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.

```js
// reducers/index.js
const {combineReducers} = require('redux');
const userReducer = require('./user');
const postReducer = require('./post');

module.exports = combineReducers({
  user: userReducer,
  posts: postReducer
});
```

â— combineReducersì•ˆì˜ ê°ì²´ì— keyê°’ë“¤ì´ initalStateë¥¼ ë”°ë¼ê°„ë‹¤ê³  ë³´ë©´ëœë‹¤.



êµ¬ì¡°ê°€ ë³€ê²½ë˜ì–´ ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤.

**prevStateê°€ ë”ì´ìƒ initialStateê°€ ì•„ë‹ˆë‹¤.**

postReducerë¥¼ ì˜ˆë¡œ ë“¤ë©´, prevStateê°€ postsë¡œ ë²”ìœ„ê°€ ì¢ì•„ì¡Œë‹¤.

ê·¸ë˜ì„œ ê·¸ëƒ¥ prevStateë¡œ ìˆ˜ì •í•´ì¤„ ìˆ˜ ìˆë‹¤.



â— shapeAssertionError ë°œìƒ

prevStateì— initialStateì— ì‘ì„±ëœ í˜•íƒœì˜ ê¸°ë³¸ê°’ì„ ë„£ì–´ì£¼ì–´ í•´ê²°

```js
// reducers/user.js
const initialState = {
  isLoggingIn: false,
  data: null,
};
const userReducer = (prevState = initialState, action) =>{
  switch(action.type){
    case 'LOG_IN':
      return{
        ...prevState,
        data: action.data,
      }
    case 'LOG_OUT':
      return{
	    isLoggingIn: false,
        data: null,
      }
    default: return prevState;
  }
};
module.exports=userReducer;
```

```js
// reducers/post.js
const initialState = [];
const postReducer = (prevState=initialState, action) =>{
  switch(action.type){
    case 'ADD_POST':
      return [...prevState, action.data];
    default: return prevState;
  }
};

module.exports = postReducer;
```

**ê²°ê³¼**

```shell
1st initialState { user: { isLoggingIn: true, data: null }, posts: [] }
chagned
2nd login {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }      
  },
  posts: []
}
chagned
3rd addPost {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }      
  },
  posts: [ { userId: 1, id: 1, content: 'Hello Redux' } ]
}
chagned
4th addPost {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }
  },
  posts: [
    { userId: 1, id: 1, content: 'Hello Redux' },
    { userId: 1, id: 2, content: 'Hello Redux2' }
  ]
}
chagned
5th logout {
  user: { isLoggingIn: false, data: null },
  posts: [
    { userId: 1, id: 1, content: 'Hello Redux' },
    { userId: 1, id: 2, content: 'Hello Redux2' }
  ]
}
```





## 02-03. ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´

actionë“¤ì€ ê¸°ë³¸ì ìœ¼ë¡œ **ë™ê¸°** ì´ë‹¤.

**actionì€ ê·¸ëƒ¥ ê°ì²´ê³ , dispatchëŠ” ê·¸ ê°ì²´ë¥¼ ë°›ì•„ dispatchí•˜ëŠ” ì—­í• ì´ë¼ ê·¸ì‚¬ì´ì— ë¹„ë™ê¸°ë¥¼ ë™ì‘í•  í‹ˆì´ ì—†ë‹¤.**

ê·¸ë˜ì„œ ì œê³µí•˜ëŠ” ê²ƒì´ **ë¯¸ë“¤ì›¨ì–´**.

dispatchì™€ reducerì‚¬ì´ì—ì„œ ë™ì‘í•˜ëŠ” ê²Œ ë¯¸ë“¤ì›¨ì–´ë‹¤.



`redux-thunk`ì™€ `redux-saga`ê°€ ìœ ëª…í•˜ë‹¤

í•­ìƒ ë¹„ë™ê¸°ë¥¼ ìœ„í•´ì„œë§Œ ì‚¬ìš©í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ dispatchì™€ reducerì‚¬ì´ì—ì„œ ì–´ë– í•œ ë™ì‘ì„ í•˜ëŠ” ê²½ìš° ì‚¬ìš©í•œë‹¤.

ê³µì‹ë¬¸ì„œì—ì„œëŠ” Loggingí•˜ëŠ” middleware ì˜ˆì œë¥¼ ì†Œê°œí•´ì¤€ë‹¤.

[ğŸ“˜ ê³µì‹ë¬¸ì„œ Logging example](https://ko.redux.js.org/understanding/history-and-design/middleware/#understanding-middleware)



middlewareë¥¼ ë§Œë“¤ì–´ë³´ì.

`createStore`ì˜ 3ë²ˆì§¸ íŒŒë¼ë¯¸í„°ê°€  `enhancer`ë¼ëŠ” ìë¦¬ì´ë‹¤.<br/>(ë¯¸ë“¤ì›¨ì–´ë¥¼ í†µí•´ì„œ ê¸°ì¡´ reduxê°€ í•  ìˆ˜ ì—†ëŠ” **ê¸°ëŠ¥ì„ ë§ë¶™ì´ëŠ”(ì¦ê°•ì‹œí‚¤ëŠ”) ì—­í• **)

```js
// index.js
const {createStore, compose, applyMiddleware} = require('redux');
...
const enhancer = compose(
  applyMiddleware(),
)
// const enhancer = applyMiddleware()

const store = createStore(reducer, initialState, enhancer);
```

composeì—†ì´ ì„ ì–¸í•´ë„ ë™ì‘í•œë‹¤.

composeê°€ í•©ì„±í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤. => applyMiddlewareë§ê³ , devtoolê°™ì€ ê±¸ ì¶”ê°€ì ìœ¼ë¡œ ë¶™ì¼ ë•Œ composeë¡œ í•©ì„±í•´ì¤€ë‹¤.

applyMiddlewareì—ëŠ” 3ë‹¨ ê³ ì°¨í•¨ìˆ˜ê°€ ë“¤ì–´ê°„ë‹¤.

```js
const firstMiddleware = (store) => (next) => (action) =>{

};

const enhancer = compose(
  applyMiddleware(firstMiddleware),
)
```

ìœ„ ê³ ì°¨í•¨ìˆ˜ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.

```js
function firstMiddleware(){
    return function(next){
        return function(action){
            
        }
    }
}
```

ì´ëŸ° ì¤‘ì²©ëœ í˜•íƒœë¥¼ ê°€ì§€ëŠ” ì´ìœ ê°€ ìˆë‹¤.

**ì‹¤í–‰ë˜ëŠ” ì‹œì ì˜ ì°¨ì´.**

storeì™€ next ì‚¬ì´ì—ì„œ ì–´ë–¤ ë™ì‘ì„ ì›í•˜ë©´ ì‚¬ì´ì—ì„œ ì‘ì„±í•˜ê³ ,

nextì™€ actionì‚¬ì´ë©´ ì‚¬ì´ ì—ì„œ ì‘ì„±.

ë§Œì•½ ì‚¬ì´ì‚¬ì´ ë™ì‘í• ê²Œ í•„ìš”ì—†ë‹¤ë©´ ê°€ì¥ ìœ„ì™€ê°™ì€ í˜•íƒœê°€ ëœë‹¤.

```js
const firstMiddleware = (store) => (next) => (action) =>{
  console.log(action)
  next(action)
};
```

**nextê°€ dispatch ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.**

consoleì´ ì—†ë‹¤ë©´ ê¸°ë³¸ê¸°ëŠ¥ì¼í…ë° consoleì„ ì¶”ê°€í•¨ìœ¼ë¡œ ì¨ dispatchì‹œ ë¡œê¹…í•˜ê²Œ ëœë‹¤.

**ì‹¤í–‰ê²°ê³¼**

```shell
1st initialState { user: { isLoggingIn: true, data: null }, posts: [] }
ì•¡ì…˜ ë¡œê¹… { type: 'LOG_IN', data: { id: 1, name: 'JuneHyung', admin: true } }
chagned
ì•¡ì…˜ ë
2nd login {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }
  },
  posts: []
}
ì•¡ì…˜ ë¡œê¹… {
  type: 'ADD_POST',
  data: { userId: 1, id: 1, content: 'Hello Redux' }
}
chagned
ì•¡ì…˜ ë
3rd addPost {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }
  },
  posts: [ { userId: 1, id: 1, content: 'Hello Redux' } ]
}
ì•¡ì…˜ ë¡œê¹… {
  type: 'ADD_POST',
  data: { userId: 1, id: 2, content: 'Hello Redux2' }
}
chagned
ì•¡ì…˜ ë
4th addPost {
  user: {
    isLoggingIn: true,
    data: { id: 1, name: 'JuneHyung', admin: true }
  },
  posts: [
    { userId: 1, id: 1, content: 'Hello Redux' },
    { userId: 1, id: 2, content: 'Hello Redux2' }
  ]
}
ì•¡ì…˜ ë¡œê¹… { type: 'LOG_OUT' }
chagned
ì•¡ì…˜ ë
5th logout {
  user: { isLoggingIn: false, data: null },
  posts: [
    { userId: 1, id: 1, content: 'Hello Redux' },
    { userId: 1, id: 2, content: 'Hello Redux2' }
  ]
}
```

ì´ë¥¼ ì´ìš©í•´ ë¹„ë™ê¸° ì²˜ë¦¬ë„ í•  ìˆ˜ ìˆë‹¤.



## 02-04. redux-thunk

middlewareëŠ” ì—¬ëŸ¬ê°œë¥¼ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.

thunkMiddlewareë¥¼ ë§Œë“¤ì–´ë³´ì.

â— ì°¸ê³  `react-thunk`ëŠ”  react ë¹„ë™ê¸°ë¥¼ ì œì–´í•˜ëŠ” ìœ ëª…í•œ ë¯¸ë“¤ì›¨ì–´ì´ë‹¤.

```js
// index.js
...

const firstMiddleware = (store) => (dispatch) => (action) =>{
  console.log('ë¡œê¹…', action)
  // ê¸°ëŠ¥ ì¶”ê°€
  dispatch(action)
};

const thunkMiddleware = (store) => (dispatch) => (action) =>{
  const thunkMiddleware = (store) => (dispatch) => (action) =>{
  if(typeof action === 'function'){ // ë¹„ë™ê¸°
    return action(store.dispatch, store.getState);
  }
  return dispatch(action)
};
  return dispatch(action)
};

const enhancer = compose(
  applyMiddleware(
    firstMiddleware, 
    thunkMiddleware,
  ),
)
```

ë¹„ë™ê¸°ì¸ ê²½ìš° actionì„ í•¨ìˆ˜ë¡œ ë„£ëŠ”ë‹¤ëŠ” ì•½ì†ì„ í•˜ê³ , ë¹„ë™ê¸°ì²˜ë¦¬ë¥¼ í•  ê²ƒì´ë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ actionì€ ë™ê¸°ì´ë‹¤. ë™ê¸°ì´ë©´ => ê°ì²´.

**ì •ë¦¬**

* actionì´ í•¨ìˆ˜ë¡œ ì˜¤ë©´ => ë¹„ë™ê¸°

* actionì´ ê·¸ì™¸ë¡œ ì˜¤ë©´ => ë™ê¸°

ìœ„ì²˜ëŸ¼ ì•½ì†.



ê·¸ëŸ¼ ì–´ë””ë¡œ ì „ë‹¬ë˜ëŠ”ê°€?

**ìš°ì„  ë¹„ë™ê¸° ì•¡ì…˜ì€ í•¨ìˆ˜ë¡œ ë§Œë“¤ ê²ƒì´ë‹¤. action creatorë‘ ì˜ êµ¬ë¶„í•´ì•¼ í•œë‹¤.**

```js
// action/user.js
const login = () => { // async action creator
  return (dispatch, state)=>{
    dispatch(loginRequest());
    setTimeout(()=>{ // ì„ì˜ë¡œ 
      dispatch(loginSuccess());
    }, 2000)
  }
}

const loginRequest = () =>{ // sync action creator
  return {}
}
const loginSuccess = () =>{ // sync action creator
  return {}
}
```

ë™ê¸° ì•¡ì…˜ë“¤ ê°„ì— ì‹¤í–‰ ìˆœì„œë¥¼ ì¡°ì‘í•˜ëŠ” ì •ë„ì´ë‹¤.



ë§ˆì € ìˆ˜ì •í•´ë³´ì.

ì£¼ì˜ ê¹Šê²Œ ë³¼ ë¶€ë¶„ì€ dataë‹¤.

``` js
// action/user.js
const login = (data) => { // async action creator
  return (dispatch, getState)=>{
    dispatch(loginRequest(data));
    setTimeout(()=>{ // ì„ì˜ë¡œ 
      dispatch(loginSuccess({
        userId: 1,
        nickname: 'zero'
      }));
    }, 2000)
  }
}

const loginRequest = (data) =>{
  return {
    type:'LOG_IN_REQUEST',
    data,
  }
}
const loginSuccess = () =>{
  return {
    type:'LOG_IN_SUCCESS',
    data,
  }
}

```

```js
const login = (data) => { // dispatchë¡œ ë„˜ê¸´ ë°ì´í„°
  return (dispatch, getState)=>{ // dispatchì—ì„œ reducerë¡œ ê°€ê¸°ì „ ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì£¼ëŠ” dispatchì™€ getState
    dispatch(loginRequest(data));
    setTimeout(()=>{ // ì„ì˜ë¡œ 
      dispatch(loginSuccess({
        userId: 1,
        nickname: 'zero'
      }));
    }, 2000)
  }
}
```

ì¢€ í–‡ê°ˆë¦¬ëŠ”ë° ì£¼ì„ì²˜ëŸ¼ ì´í•´í–ˆë‹¤.



**ë‹¤ì‹œ í•œë²ˆ ì •ë¦¬**

```js
const thunkMiddleware = (store) => (dispatch) => (action) =>{
  if(typeof action === 'function'){
    return action(store.dispatch, store.getState);
  }
  return dispatch(action)
};
```

1. dispatchë¡œ ê°ì²´ê°€ ì˜¬ìˆ˜ë„ í•¨ìˆ˜ë¡œ ì˜¬ ìˆ˜ë„ ìˆë‹¤.<br/>í•¨ìˆ˜ë¡œ ì˜¤ëŠ” ê²½ìš° ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•½ì†.
2. ë§Œì•½ ê°ì²´ë¡œ ì™”ë‹¤ë©´ ê·¸ëƒ¥ ê¸°ë³¸ë™ì‘ì„ ì‹œí‚¨ë‹¤. `return dispatch(action)`
3. í•¨ìˆ˜ ì¸ê²½ìš° `action(store.dispatch, store.getState)`ê°€ ë™ì‘.

```js
const login = (data) => { // dispatchë¡œ ë„˜ê¸´ ë°ì´í„°
  return (dispatch, getState)=>{ // dispatchì—ì„œ reducerë¡œ ê°€ê¸°ì „ ë¯¸ë“¤ì›¨ì–´ì—ì„œ ì£¼ëŠ” dispatchì™€ getState
    dispatch(loginRequest(data));
    setTimeout(()=>{ // ì„ì˜ë¡œ 
      dispatch(loginSuccess({
        userId: 1,
        nickname: 'zero'
      }));
    }, 2000)
  }
}
```

4. ë¯¸ë“¤ì›¨ì–´ëŠ” dispatch -> reducerë¡œ ê°€ê¸°ì „ì— ë™ì‘í•˜ê¸° ë•Œë¬¸ì— í•¨ìˆ˜ í˜•íƒœë„ dispatchë¡œ ë°›ì€ dataê°€ ê°€ì¥ë°–ì—ì„œ ë°›ê³ , returnë¶€ë¶„ì— middlewareì—ì„œ ë°›ì€ dispatchì™€ getStateê°’ì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ”ë‹¤.<br/>returnë¶€ë¶„ì´ ì›ë˜ action creatorì˜ actionìë¦¬ì´ë‹ˆê¹Œ.

> ì™œ redux-thunkë¥¼ ê°€ì ¸ì˜¤ì§€ ì•Šê³ , ë§Œë“¤ì–´ ì“°ëŠ”ê°€?
>
> ì‹¤ì œë¡œ redux-thunkì˜ ë‚´ìš©ë„ ì§€ê¸ˆ ì‘ì„±í•œê²ƒê³¼ ë‹¤ë¥¼ ë°” ì—†ë‹¤.
>
> [ğŸ“˜ redux.jsì˜ redux-thunk Github](https://github.com/reduxjs/redux-thunk/blob/master/src/index.ts)

ì¶”ê°€ì ì¸ ì—ëŸ¬ì²˜ë¦¬

```javascript
const login = (data) => { // async action creator
  return (dispatch, getState)=>{
    dispatch(loginRequest(data));
    try{
      setTimeout(()=>{ // ì„ì˜ë¡œ 
        dispatch(loginSuccess({
          userId: 1,
          nickname: 'zero'
        }));
      }, 2000)
    }catch(e){
      dispatch(loginFailure(e))
    }
  }
}

const loginRequest = (data) =>{
  return {
    type:'LOG_IN_REQUEST',
    data,
  }
}
const loginSuccess = () =>{
  return {
    type:'LOG_IN_SUCCESS',
    data,
  }
}
const loginFailure = (error) =>{
  return {
    type:'LOG_IN_FAILURE',
    error,
  }
}
```

í•¨ìˆ˜ì˜ í˜•íƒœê°€ `firstMiddleware = (store, dispatch, action) => {...}`ì´ ì•„ë‹Œ ì´ìœ ëŠ” í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì˜ íŠ¹ì„±(ë§¤ê°œ ë³€ìˆ˜ëŠ” í•˜ë‚˜ë§Œ ë°›ìŒ) ë•Œë¬¸.

ì´ëŸ° ë°©ì‹ì„ **ì»¤ë§ ë°©ì‹(Currying)** ì´ë¼í•œë‹¤.

> **ê³ ì°¨í•¨ìˆ˜ì™€ ì»¤ë§(Currying) ê¸°ë²•**
>
> ê³ ì°¨í•¨ìˆ˜ëŠ” í•¨ìˆ˜ë¥¼ ì¸ìë¡œ ì „ë‹¬ë°›ê±°ë‚˜ ë¦¬í„´ê°’ìœ¼ë¡œ í•¨ìˆ˜ë¥¼ ë°˜í™˜í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì˜ë¯¸.
>
> ```js
> const demo = function (){
>     console.log('demo')
> }
> 
> const a = function(func) {
>     function b(word){
>         func();
>         console.log(word);
>     }
>     return b;
> }
> 
> const test = a(demo);
> test("testing");
> // demo ì¶œë ¥
> // testingì¶œë ¥
> 
> //----------------------------------------------------------------
> 
> function a = (func) => (word) => {
>     func();
>     console.log(word);
> }
> ```
>
> 
>
> ì»¤ë§ê¸°ë²•ì€ ì¸ìê°€ ì—¬ëŸ¬ê°œì¸ í•¨ìˆ˜ì˜ ì¼ë¶€ ì¸ìë¥¼ ê³ ì •ì‹œí‚¤ëŠ” ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ë§Œë“œëŠ” ê¸°ë²•.
>
> ì¦‰, ì¸ìê°€ nê°œì¸ í•¨ìˆ˜ë¥¼ nê°œë¡œ ë¶„ë¦¬í•˜ì—¬ ì‚¬ìš©í•˜ê²Œë” ë§Œë“œëŠ” ê¸°ë²•.
>
> ì¼ë¶€ ì¸ìì— ê°™ì€ ê°’ì„ ë°˜ë³µì ìœ¼ë¡œ ì‚¬ìš©í•  ë–„ ê·¸ ë°˜ë³µë˜ëŠ” ì¸ìë¥¼ ê³ ì •í•¨ìœ¼ë¡œì¨ ì¤‘ë³µì„ ìµœì†Œí™” í•˜ê¸°ì— ì í•©í•œ ê¸°ë²•
>
> ```js
> function helloFunc(word, name, word2, name2) {
>     console.log(`${word}, ${name} || ${word2}, ${name2}`);
> }
> //------------------------------------------------------------------------------
> function helloFunc(word) {
>     return function (name) {
>         return function(word2){
>             return function(name2){
>                 console.log(`${word}, ${name} || ${word2}, ${name2}`)
>             }
>         }
>     };
> }
> //------------------------------------------------------------------------------
> const helloFunc = (word) => (name) => (word2) => (name2) => {
>     console.log(`${word}, ${name} || ${word2}, ${name2}`);
> };
> ```
>
> â— ì¸ìì˜ ìˆœì„œê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤.
>
> ë³€ë™ê°€ëŠ¥ì„±ì´ ì ì€ ì¸ìëŠ” ì•, ë³€ë™ê°€ëŠ¥ì„±ì´ í° ì¸ìëŠ” ë’¤ì— ë°°ì¹˜.
>
> [ğŸ“˜ ê³ ì°¨í•¨ìˆ˜ì™€ ì»¤ë§ê¸°ë²• ì°¸ê³ ](https://tibetsandfox.tistory.com/32)



**ê²°ê³¼**

 ```javascript
 // index.js
 const {createStore, compose, applyMiddleware} = require('redux');
 
 const reducer = require('./reducers');
 const {login, logout } = require('./actions/user');
 const {addPost } = require('./actions/post');
 
 const initialState = {
   user: {
     isLoggingIn: true,
     data:null,
   },
   posts: [],
   // comments: [],
   // favorites: [],
   // history: [],
   // likes: [],
   // followers: [],
 }
 
 const firstMiddleware = (store) => (dispatch) => (action) =>{
   console.log('ë¡œê¹…', action)
   // ê¸°ëŠ¥ ì¶”ê°€
   dispatch(action)
 };
 
 const thunkMiddleware = (store) => (dispatch) => (action) =>{
   if(typeof action === 'function'){
     return action(store.dispatch, store.getState);
   }
   return dispatch(action)
 };
 
 const enhancer = compose(
   applyMiddleware(
     firstMiddleware, 
     thunkMiddleware,
   ),
 )
 
 const store = createStore(reducer, initialState, enhancer);
 
 console.log('1st initialState',  store.getState());
 store.dispatch(login({
   id: 1,
   name: 'zero',
   admin: true,
 }))
 console.log('2nd login',  store.getState());
 ```



2ì´ˆë’¤ì— SUCCESSë¶€ë¶„ì´ ì¶œë ¥ë˜ëŠ”ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

```shell
1st initialState { user: { isLoggingIn: true, data: null }, posts: [] }
ë¡œê¹… [Function (anonymous)]
ë¡œê¹… { type: 'LOG_IN_REQUEST', data: { id: 1, name: 'zero', admin: true } }
2nd login { user: { isLoggingIn: true, data: null }, posts: [] }
ë¡œê¹… { type: 'LOG_IN_SUCCESS', data: { userId: 1, nickname: 'zero' } }
```



â— thunkëŠ” ê°„ë‹¨í•˜ì§€ë§Œ, ë¹„ë™ê¸°ëŠ” ë³µì¡í•˜ë‹¤. ë¹„ë™ê¸°ë¼ë¦¬ ì„œë¡œ ì–½íˆë‹¤ê°€ thunkë§Œìœ¼ë¡œ í•´ê²°ì´ ì–´ë ¤ìš¸ë•Œ  `redux-saga`ë¥¼ ì‚¬ìš©.



## 02-05. react-redux

reactì—ì„œ í•´ë³´ì.

### í”„ë¡œì íŠ¸ ì„¸íŒ… 

(webgameì˜ mineSearchë•Œ ì‚¬ìš©í•œ ì„¸íŒ…ì— ì¶”ê°€,ë³€ê²½)

```shell
npm i react react-dom
npm i -D @babel/core @babel/preset-env @babel/preset-react babel-loader
npm i-D react-hot-loader webpack webpack-cli webpack-dev-server
```

ê·¸ë¦¬ê³  reactì™€ reduxë¥¼ ì—°ê²°í•˜ê¸° ìœ„í•´ì„œ react-reduxê°€ í•„ìš”í•˜ë‹¤

```shell
npm i react-redux
```



`client.jsx`ì—ì„œëŠ” Appì„ ë Œë”í•˜ë„ë¡ ìˆ˜ì •.

```jsx
// client.jsx
import React from 'react';
import ReactDOM from 'react-dom/client';

import App from './App';

ReactDOM.createRoot(document.querySelector('#root')).render(<App />);
```



index.html ì¶”ê°€

```html
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¦¬ë•ìŠ¤ ì—°ê²°</title>
</head>
<body>
  <div id="root"></div>
  <script src="./dist/app.js"></script>
</body>
</html>
```

App.jsx ì‘ì„± í›„ ì‹¤í–‰ ì‹œì¼œ í™•ì¸í•´ë³´ê¸°.

```jsx
import React from 'react';

const App = () => {
  return (
    <div>Hello react-redux</div>
  )
};

export default App;
```

![react_setting](./readme_images/02.react_setting.png)



ì´ì „ì— ì‘ì—…í•œ actionsì™€ reducersí´ë”ë¥¼ ì˜®ê¸°ê³  ê¸°ì¡´ì— ì‘ì„±í•œ index.jsëŠ” store.jsë¡œ ë³€ê²½

```javascript
// store.js
...
const store = createStore(reducer, initialState, enhancer);

module.exports = store;
```



storeë¥¼ clientì—ì„œ Providerë¡œ ê°ì‹¸ì¤€ë‹¤.

```jsx
// client.jsx
import React from 'react';
import ReactDOM from 'react-dom/client';
import { Provider } from 'react-redux';
import store from './store';

import App from './App';

ReactDOM.createRoot(document.querySelector('#root')).render(
<Provider store={store}>
  <App />
</Provider>
);

```

ì´ëŸ¬ë©´ react, react-redux, reduxê°€ ì—°ê²°ë˜ì—ˆë‹¤



App.jsxë¥¼ ìˆ˜ì •í•´ë³´ì.

```jsx
import React, { useCallback } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { login } from './actions/user';

const App = () => {
  const user = useSelector((state)=>state.user.data)
  const dispatch = useDispatch();
  const onClick = useCallback(() =>{
    dispatch(login({
      id: 'jhjoe',
      password: 'ë¹„ë°€ë²ˆí˜¸'
    }))
  }, [])
  return (
    <div>
      {user ? <div>{user.nickname}</div> : 'ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.'}
      <button onClick={onClick}>ë¡œê·¸ì¸</button>
    </div>
  )
};

export default App;
```

â— `react-redux`ì—ëŠ” useDispatchì™€ useSelectorê°€ ìˆë‹¤.

useDispatchëŠ” dispatchë¥¼ í•˜ê¸°ìœ„í•œ í•¨ìˆ˜, useSelectorëŠ” stateì—ì„œ ì›í•˜ëŠ” dataë¥¼ ê³ ë¥´ëŠ” í•¨ìˆ˜.

ë¡œê·¸ì¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.

`redux-devtools`ë¥¼ í†µí•´  ê¸°ë¡ í™•ì¸ì´ ê°€ëŠ¥.



## 02-06. QnA

ìš°ì„  ì´ë¦„ì´ ê³„ì† ì¶œë ¥ë˜ì§€ ì•ŠëŠ”ë‹¤.

ì´ì „ì— actionìœ¼ë¡œ successì™€ failureë¥¼ ë§Œë“¤ì—ˆëŠ”ë° reducerë“¤ì„ ì•ˆë§Œë“¤ì–´ ì¤Œ.

(ìƒìˆ˜ëŠ” ë³„ë„ íŒŒì¼ë¡œ ë¶„ë¦¬í•˜ì˜€ë‹¤.)

```javascript
// reducers/user.js
const { LOG_IN_REQUEST, LOG_IN_SUCCESS, LOG_IN_FAILURE, LOG_OUT } = require("../constant");

const initialState = {
  isLoggingIn: false,
  data: null,
};
const userReducer = (prevState = initialState, action) =>{
  switch(action.type){
    case LOG_IN_REQUEST:
      return{
        ...prevState,
        data:null,
        isLoggingIn: true,
      }
    case LOG_IN_SUCCESS:
      return{
        ...prevState,
        data: action.data,
        isLoggingIn: true,
      }
    case LOG_IN_FAILURE:
        return{
          ...prevState,
          data: null,
          isLoggingIn: false,
        }
    case LOG_OUT:
      return{
        ...prevState,
        data: null,
      }
    default: return prevState;
  }
};

module.exports=userReducer;
```



App.jsxì—ì„œ ë¡œê·¸ì¸í•¨ì— ë”°ë¥¸ displayë³€ê²½ê³¼ ë¡œê·¸ì•„ì›ƒë²„íŠ¼ì„ ì¶”ê°€í•´ë³´ì.

```jsx
// App.jsx
import React, { useCallback } from 'react';
import { useDispatch, useSelector } from 'react-redux';
import { login, logout } from './actions/user';

const App = () => {
  const user = useSelector((state)=>state.user)
  const dispatch = useDispatch();
  const onClick = useCallback(() =>{
    dispatch(login({
      id: 'jhjoe',
      password: 'ë¹„ë°€ë²ˆí˜¸'
    }))
  }, [])
  const onLogout = useCallback(() =>{
    dispatch(logout())
  }, [])
  return (
    <div>
      {user.isLoggingIn 
        ? <div>ë¡œê·¸ì¸ ì¤‘</div> 
        : user.data 
        ? <div>{user.data.nickname}</div> 
        : 'ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.'
      }
      {!user.data ? <button onClick={onClick}>ë¡œê·¸ì¸</button> : <button onClick={onLogout}>ë¡œê·¸ì•„ì›ƒ</button>}
    </div>
  )
};

export default App;
```

Q. ë¹„ë™ê¸° ì•¡ì…˜ë“¤ì„ clickë©”ì„œë“œì—ì„œ ë°”ë¡œ ì²˜ë¦¬í•´ë„ ë˜ì§€ì•ŠëŠ”ê°€.?

A. ê°€ëŠ¥ì€ í•˜ì§€ë§Œ, ê´€ë¦¬ì¸¡ë©´ì—ì„œ ë¶„ë¦¬í•˜ëŠ”ê²Œ ì¢‹ë‹¤.



## 02-07. redux-devtoolsì™€ connect

redux-devtools ì„¤ì • í•´ë³´ì.

```shell
npm i -D redux-devtools-extension
```

ê°œë°œìš©ìœ¼ë¡œ ì„¤ì¹˜.

ë°°í¬í™˜ê²½ì´ ì•„ë‹ˆë¼ clientê°€ ì ‘ì†í•˜ëŠ” í™˜ê²½ì—ì„œ devtoolsë¥¼ ì“°ê²Œë˜ë©´, ì›¹í”„ë¡œì íŠ¸ì˜ ë°ì´í„°ê°€ reduxì— ëª¨ì•„ì ¸ìˆê¸° ë•Œë¬¸ì— ìœ ì¶œë  ìˆ˜ë„ ìˆë‹¤.

`composeWithDevTools`ë¥¼ ê°€ì ¸ì™€ enhancerì—ì„œ ì‘ì„±í•œ applyMiddlewareë¥¼ composeWthDevToolsì•ˆì— ë„£ìœ¼ë©´ëœë‹¤.

```jsx
composeWithDevTools(
    applyMiddleware(
        firstMiddleware,
        thunkMiddleware,
    ),
);
```

ë§Œì•½ ë°°í¬í™˜ê²½ì—ì„œ ì‚¬ìš©í•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´

```jsx
const enhancer = process.env.NODE_ENV === 'production'
? compose(
    applyMiddleware(
        firstMiddleware,
        thunkMiddleware,
    ),
)
: composeWithDevTools(
    applyMiddleware(
        firstMiddleware,
        thunkMiddleware,
    ),
);
```

ì´ëŸ° ì‹ìœ¼ë¡œ productionì¸ ê²½ìš° composeë§Œ, ì•„ë‹ˆë¼ë©´ composeWithDevToolsë¥¼ ì‚¬ìš©.





ê¸°ì¡´ class ì»´í¬ë„ŒíŠ¸ì—ì„œ ê¸°ì¡´ë°©ì‹ì¸ connectì™€ reducerë¥¼ í¸í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” immerì— ëŒ€í•´ ì•Œì•„ë³´ì.

ê¸°ì¡´ ì‘ì„±í•œ íŒŒì¼ë“¤ì„ ë³µì‚¬í•´ì„œ classë¡œ ë°”ê¾¸ì–´ ì§„í–‰.

```jsx
import React, { useCallback } from 'react';
import { connect } from 'react-redux';
import { login, logout } from './actions/user';
class App{
  onClick = ()=>{
    dispatch(login({
      id: 'jhjoe',
      password: 'ë¹„ë°€ë²ˆí˜¸'
    }))
  }
  onLogout = () =>{
    dispatch(logout())
  }
  render(){
    const {user} = this.props;
return (
    <div>
      {user.isLoggingIn 
        ? 'ë¡œê·¸ì¸ ì¤‘'
        : user.data 
        ? user.data.nickname
        : 'ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”.'}
      {!user.data 
        ? <button onClick={this.onClick}>ë¡œê·¸ì¸</button> 
        : <button onClick={this.onLogout}>ë¡œê·¸ì•„ì›ƒ</button>}
    </div>
  )
  }
}

export default connect()(App);
```

classì—ì„œëŠ” connectë¥¼ ì‚¬ìš©. í•˜ì´ì˜¤ë”ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ìš©í•´ Appì„ í™•ì¥.

Hooksì—ì„œ ì²˜ëŸ¼ stateì™€ dispatchë¥¼ ê°€ì ¸ì™€ì•¼í•œë‹¤.

```jsx
// App.jsx
...

const mapStateToProps = (state) => ({
  user: state.user,
}) // reselct
const mapDispatchToProps = (dispatch) => ({
  dispatchLogin:(data)=> dispatch(login(data)),
  dispatchLogout: ()=> dispatch(logout()),
})
```

â— ë¬¸ì œê°€ ìˆë‹¤.

ì»´í¬ë„ŒíŠ¸ê°€ ë Œë”ë§ ë ë•Œë§ˆë‹¤ ì‹¤í–‰í•˜ê²Œ ë˜ì„œ ì„±ëŠ¥ìƒì˜ ë¬¸ì œê°€ ë°œìƒí• ìˆ˜ ìˆë‹¤.

=> `reselect`ë¥¼ ì¨ì•¼í•œë‹¤.



mapStateToPropsì™€ mapDispatchToPropsì— ì„ ì–¸í•œ ê²ƒë“¤ì€ propsì—ì„œ ë°›ì„ ìˆ˜ ìˆë‹¤.

```jsx
class App{
  onClick = ()=>{
    this.props.dispatchLogin({
      id: 'jhjoe',
      password: 'ë¹„ë°€ë²ˆí˜¸'
    })
  }
  onLogout = () =>{
    this.props.dispatchLogin()
  }
  render(){
    const {user} = this.props;
return (
    ...
)}
```



## 02-08. immer

reducerì—ì„œ ë¶ˆë³€ì„±ì„ ì§€í‚¤ê¸° ìœ„í•´ ìŠ¤í”„ë ˆë“œ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ì§ê´€ì ì´ì§€ ì•Šë‹¤.

ì¢€ ê¹Šì´ê°€ ìˆëŠ” ê°’ì„ ë°”ê¾¼ë‹¤ê³  ê°€ì •í•´ë³´ì.

ì•„ë˜ì²˜ëŸ¼ ê³„ì† ì¨ì¤˜ì•¼í•œë‹¤.

```jsx
state.deep.depper.deepest.a = 'b';
// -------------------------------------------------
return {
    deep: {
        ...prevState.deep,
        deeper:{
            ...prevState.deepper,
            deepest: {
                ...prevState.deepest,
                a
            }
        }
    }
}
```



immer ì„¤ì¹˜

```shell
npm i immer
```

ê¸°ë³¸ í˜•íƒœ

```jsx
const produce = require('immer')

nextState = produce(prevState, (draft)=>{})
```

produceí•¨ìˆ˜ëŠ” ì´ì „ ìƒíƒœë¥¼ ë°”íƒ•ìœ¼ë¡œ ì•¡ì…˜ì„ ë°›ì•„ì„œ nextStateë¥¼ ë§Œë“ ë‹¤ê³  ìƒê°.

draftëŠ” prevStateì˜ ë³µì‚¬ë³¸ì´ë¼ ìƒê°í•˜ë©´ ëœë‹¤.

prevStateëŠ” ë¶ˆë³€ì„±ì„ ì§€í‚¤ê¸° ìœ„í•´ ëƒ…ë‘ê³  ê·¸ ë³µì‚¬ë³¸ì¸ draftë¥¼ ìˆ˜ì •í•˜ëŠ” í˜•ì‹.

ê·¸ì—ë”°ë¼ reducerë¥¼ ìˆ˜ì •í•´ë³´ì. 

```jsx
// reducers/user.js
const userReducer = (prevState = initialState, action) =>{
  return produce(prevState, (draft)=>{
    switch(action.type){
      case LOG_IN_REQUEST:
        draft.data = null;
        draft.isLoggingIn = true;
        break;
      case LOG_IN_SUCCESS:
        draft.data = action.data;
        draft.isLoggingIn = false;
        break;
      case LOG_IN_FAILURE:
        draft.data = null;
        draft.isLoggingIn = false;
        break;
      case LOG_OUT:
        draft.data = null;
        break;
      default: break;
    }
  })
};
```

codeê°€ ì—„ì²­ ì¤„ì–´ë“ ê±¸ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ğŸ‘

postë„ ìˆ˜ì •.

```js
const { ADD_POST } = require("../constant");
const produce = require('immer')

const initialState = [];
const postReducer = (prevState=initialState, action) =>{
  return produce(prevState, (draft)=>{
    switch(action.type){
      case ADD_POST:
        draft.push(action.data);
        break;
      default: break;
    }
  })
};

module.exports = postReducer;
```

zerochoë‹˜ gtihubì˜ nodebird ì±•í„° 6ì™€ ì±•í„° 7ì˜ ì°¨ì´ë¥¼ ë¹„êµ.(ì•„ë˜ ë§í¬ëŠ” ì±•í„°7)



```jsx
// App.jsx
import React, { Component } from "react";
import { connect } from "react-redux";
import { login, logout } from "./actions/user";

class App extends Component {
  onClick = () => {
    this.props.dispatchLogin({
      id: "jhjoe",
      password: "ë¹„ë°€ë²ˆí˜¸",
    });
  };
  onLogout = () => {
    this.props.dispatchLogout();
  };
  render() {
    const { user } = this.props;
    return (
      <div>
        {user.isLoggingIn ? "ë¡œê·¸ì¸ ì¤‘" : user.data ? user.data.nickname : "ë¡œê·¸ì¸ í•´ì£¼ì„¸ìš”."}
        {!user.data ? <button onClick={this.onClick}>ë¡œê·¸ì¸</button> : <button onClick={this.onLogout}>ë¡œê·¸ì•„ì›ƒ</button>}
      </div>
    );
  }
}

const mapStateToProps = (state) => ({
  user: state.user,
}); // reselct
const mapDispatchToProps = (dispatch) => ({
  dispatchLogin: (data) => dispatch(login(data)),
  dispatchLogout: () => dispatch(logout()),
});
export default connect(mapStateToProps, mapDispatchToProps)(App);

```



> â— ì°¸ê³ 
>
> import ì™€ requireë¥¼ ì‰½ê²Œ ë°”ê¿€ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤.
>
> í•˜ì§€ë§Œ ë‘ê°œê°€ ë‹¤ë¥¸ ê¸°ëŠ¥ì¸ê±¸ ì•Œì•„ì•¼í•œë‹¤.
>
> ì°¨ì´ì  í•œê°€ì§€ë§Œ ë§í•˜ìë©´, defaultê°€ ë‹¤ë¥´ë‹¤.



ğŸ“˜ [nodebird Github chapter7 reducer](https://github.com/ZeroCho/react-nodebird/blob/master/ch7/front/reducers/user.js)